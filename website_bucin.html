<!doctype html>
<html lang="id">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Website Bucin - Permainan Ular</title>
  <style>
    :root{
      --pink:#ffd6e0;
      --orange:#ffd9b3;
      --accent:#ff6f91;
      --text:#333;
    }
    html,body{height:100%;margin:0;font-family:Inter,system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial,'Noto Sans',sans-serif;background:linear-gradient(135deg,var(--pink),var(--orange));color:var(--text);overflow-x:hidden}
    .wrap{max-width:980px;margin:18px auto;padding:18px;background:rgba(255,255,255,0.55);border-radius:18px;box-shadow:0 6px 30px rgba(0,0,0,0.08);animation:fadeIn 0.8s ease}
    @keyframes fadeIn{from{opacity:0;transform:translateY(10px)}to{opacity:1;transform:none}}

    header{display:flex;align-items:center;justify-content:space-between;gap:12px}
    h1{margin:0;font-size:1.6rem;color:var(--accent)}
    .controls{display:flex;gap:8px;align-items:center}
    button{background:var(--accent);border:none;color:white;padding:8px 12px;border-radius:10px;font-weight:600;cursor:pointer;transition:.2s}
    button:hover{opacity:.85}
    button.secondary{background:transparent;border:2px solid rgba(0,0,0,0.06);color:var(--text)}

    .game-area{display:flex;flex-direction:column;align-items:center;margin-top:14px}
    canvas{background:rgba(255,255,255,0.9);border-radius:12px;box-shadow:0 8px 30px rgba(0,0,0,0.06);max-width:100%;height:auto;transition:0.2s}

    .info{margin-top:8px;display:flex;gap:12px;align-items:center;font-size:0.95rem}

    .overlay{position:fixed;inset:0;display:flex;align-items:center;justify-content:center;background:rgba(0,0,0,0.4);padding:20px;pointer-events:none;animation:fadeIn .5s}
    .card{background:white;padding:18px;border-radius:18px;box-shadow:0 12px 40px rgba(0,0,0,0.12);max-width:720px;width:100%;text-align:center;pointer-events:auto;animation:pop .45s ease}
    @keyframes pop{0%{transform:scale(.8);opacity:0}100%{transform:scale(1);opacity:1}}
    .hidden{display:none}

    .result-image{max-width:100%;height:auto;border-radius:12px;margin-top:14px;box-shadow:0 6px 20px rgba(0,0,0,0.15)}

    .messages{margin-top:12px;font-size:1rem;line-height:1.45;display:flex;flex-direction:column;gap:8px}

    .share-box{margin-top:16px;display:flex;justify-content:center;gap:12px}
    .share-btn{padding:8px 14px;border-radius:10px;border:none;color:white;background:#ff8f4e;font-weight:600;cursor:pointer}

    footer{margin-top:18px;text-align:center;color:rgba(0,0,0,0.55);font-size:0.9rem}

  </style>
</head>
<body>
  <div class="wrap">
    <header>
      <h1>Website Bucin ‚Äî Main Ular</h1>
      <div class="controls">
        <button id="startBtn">Mulai</button>
        <button id="restartBtn" class="secondary">Restart</button>
      </div>
    </header>

    <section class="game-area">
      <canvas id="game" width="540" height="360"></canvas>
      <div class="info">
        <div>Skor: <span id="score">0</span></div>
        <div>Kontrol: ‚Üê ‚Üë ‚Üí ‚Üì / Geser di layar</div>
      </div>
    </section>

    <footer>Letakkan musik di <code>assets/music.mp3</code> & gambar di <code>assets/result.jpg</code>.</footer>
  </div>

  <audio id="bgMusic" src="assets/music.mp3" preload="auto"></audio>

  <div id="afterOverlay" class="overlay hidden">
    <div class="card" id="card">
      <h2 id="resultTitle">Game Over!</h2>
      <p id="resultText">Ular menabrak dinding. Musik diputar‚Ä¶</p>
      <img id="resultImage" class="result-image hidden" src="assets/result.jpg" alt="Hasil Anda" />
      <div class="messages hidden" id="messages"></div>

      <div class="share-box hidden" id="shareBox">
        <button class="share-btn" id="waShare">Bagikan WA</button>
        <button class="share-btn" id="igShare">Bagikan IG</button>
      </div>

      <div style="margin-top:12px"><button id="closeOverlay">Tutup</button></div>
    </div>
  </div>

<script>
// ----- GAME -----
const canvas = document.getElementById('game');
const ctx = canvas.getContext('2d');
let tileSize = 18;
let cols, rows;
let snake, dir, food;
let score = 0;
let isRunning = false;
let gameInterval = null;
let speed = 100;

function resetGame(){
  cols = Math.floor(canvas.width/tileSize);
  rows = Math.floor(canvas.height/tileSize);
  snake = [{x:Math.floor(cols/2),y:Math.floor(rows/2)}];
  dir = {x:1,y:0};
  placeFood();
  score = 0;
  document.getElementById("score").textContent = score;
  isRunning = false;
  clearInterval(gameInterval);
  draw();
}

function placeFood(){ food = {x:Math.floor(Math.random()*cols), y:Math.floor(Math.random()*rows)}; }

function drawCell(x,y,color){
  ctx.fillStyle=color;
  ctx.fillRect(x*tileSize+1,y*tileSize+1,tileSize-2,tileSize-2);
}

function draw(){
  ctx.clearRect(0,0,canvas.width,canvas.height);
  drawCell(food.x, food.y, '#ff8fa3');
  snake.forEach((s,i)=>drawCell(s.x,s.y,i===0?'#ff6f91':'#ffb3c6'));
}

function step(){
  const head={x:snake[0].x+dir.x,y:snake[0].y+dir.y};
  if(head.x<0||head.x>=cols||head.y<0||head.y>=rows) return endGame();
  for(const s of snake){ if(s.x===head.x&&s.y===head.y) return endGame(); }
  snake.unshift(head);
  if(head.x===food.x&&head.y===food.y){ score+=10; document.getElementById("score").textContent=score; placeFood(); }
  else snake.pop();
  draw();
}

function startGame(){ if(!isRunning){isRunning=true; gameInterval=setInterval(step,speed);} }

function endGame(){
  isRunning=false;
  clearInterval(gameInterval);
  document.getElementById('afterOverlay').classList.remove('hidden');
  const bgMusic=document.getElementById('bgMusic');
  try{ bgMusic.currentTime=0; bgMusic.play(); }catch{};
  bgMusic.onended = showPostScreen;
  setTimeout(()=>{ if(bgMusic.paused) showPostScreen(); },5000);
}

function showPostScreen(){
  document.getElementById('resultImage').classList.remove('hidden');
  const msgBox=document.getElementById('messages');
  msgBox.classList.remove('hidden');

  const lines=[
    "Kamu itu manis‚Ä¶ kayak es krim meleleh siang bolong.",
    "Kalau kamu jadi lagu, aku repeat seharian.",
    "Ada banyak alasan buat bahagia, tapi kamu paling simpel dan ampuh.",
    "Humormu itu aneh, tapi entah kenapa bikin aku kangen.",
    "Kamu bukan wifi, tapi koneksi kita kenceng.",
    "Hidup ini lucu. Dulu sendiri. Sekarang ada kamu, tambah lucu.",
    "Kalau ketawa bisa bikin awet muda, aku bakal panjang umur gara-gara kamu.",
    "Cinta itu seperti mie instan ‚Äî simpel, hangat, dan bikin ketagihan."
  ];

  let i=0;
  function next(){ if(i>=lines.length) return showShare(); const d=document.createElement('div'); d.textContent=lines[i]; msgBox.appendChild(d); i++; setTimeout(next,1400);} next();
}

function showShare(){ document.getElementById('shareBox').classList.remove('hidden'); }

// Share
const wa=document.getElementById('waShare');
wa.onclick=()=>{ window.open(`https://wa.me/?text=Main%20game%20bucin%20bareng%20aku%20dong!%20üíñ`, '_blank'); };

const ig=document.getElementById('igShare');
ig.onclick=()=>{ alert('Untuk IG: screenshot halaman lalu upload manual ya üòÑ'); };

// Controls
window.addEventListener('keydown',e=>{
  if(!isRunning) return;
  if(e.key==='ArrowUp'&&dir.y!==1) dir={x:0,y:-1};
  if(e.key==='ArrowDown'&&dir.y!==-1) dir={x:0,y:1};
  if(e.key==='ArrowLeft'&&dir.x!==1) dir={x:-1,y:0};
  if(e.key==='ArrowRight'&&dir.x!==-1) dir={x:1,y:0};
});

// Touch
let touchStart=null;
canvas.addEventListener('touchstart', e=>touchStart=e.changedTouches[0]);
canvas.addEventListener('touchend', e=>{
  if(!touchStart) return;
  const t=e.changedTouches[0], dx=t.clientX-touchStart.clientX, dy=t.clientY-touchStart.clientY;
  if(Math.abs(dx)>Math.abs(dy)){
    if(dx>20&&dir.x!==-1) dir={x:1,y:0};
    if(dx<-20&&dir.x!==1) dir={x:-1,y:0};
  } else {
    if(dy>20&&dir.y!==-1) dir={x:0,y:1};
    if(dy<-20&&dir.y!==1) dir={x:0,y:-1};
  }
  touchStart=null;
});

// Resize responsive
function fitCanvas(){
  const ratio=3/2; const maxW=Math.min(window.innerWidth-40,900);
  const w=Math.floor(maxW/18)*18; const h=Math.floor((w/ratio)/18)*18;
  canvas.width=w; canvas.height=h;
  tileSize=18; cols=Math.floor(w/tileSize); rows=Math.floor(h/tileSize);
  draw();
}

window.addEventListener('resize', ()=>{ fitCanvas(); resetGame(); });

document.getElementById('startBtn').onclick=startGame;
document.getElementById('restartBtn').onclick=()=>{resetGame();startGame();};
document.getElementById('closeOverlay').onclick=()=>document.getElementById('afterOverlay').classList.add('hidden');

fitCanvas(); resetGame();
canvas.addEventListener('click',()=>{ if(!isRunning) startGame(); });
</script>
</body>
</html>
